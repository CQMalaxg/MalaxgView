# 变化检测功能使用说明

## 功能界面

在左侧导航栏选择“变化检测”进入。

<p align="center">
    <img src="https://user-images.githubusercontent.com/21275753/199180505-90db6cee-9e10-4f7e-8cce-2a482ea8aa6b.png" alt = "pic" width = "600" />
</p>

## 功能描述

对同一地点不同时期的两幅影像进行分析，定位区域内发生的变化情况。GeoView目前仅支持二类变化检测任务，即，结果中以不同颜色标识“变化”与“不变”。

## 操作流程演示

<p align="center">
    <img src="https://user-images.githubusercontent.com/21275753/199176961-97466391-6cea-4a11-999a-78b8b0e0d602.gif" alt = "demo" width = "600" />
</p>

## 使用方法

### 基本使用

1. 分别上传两个时相的影像。对于每个时相，单击“点击上传”选择单张或多张图像，或点击“上传文件夹”选择包含多张图像的文件夹。如果需要编辑上传的图片，例如进行裁剪、缩放等操作，请勾选“上传时编辑图片”（该操作仅适用于上传单张图像的情形）。关于图像在线编辑的功能请参考[文档](./edit_image.md)。点击“清空图片”可以撤销选择。为了正确匹配影像对，请确保不同时相对应的图像具有相同的文件名。
2. 在“可选训练模型”中选择需要使用的模型。
3. 点击“开始处理”提交任务，等待模型处理完毕后可在下方获取解译结果。若上传多个影像对或上传文件夹，每次可以选择一个结果查看。在“相关信息”栏中，可以查看变化实例的个数以及变化像素所占百分比。如下图所示：

<p align="center">
    <img src="https://user-images.githubusercontent.com/21275753/199179778-8bdb8052-e65f-423b-a1ee-905223353fc1.png" alt = "res" width = "600" />
</p>

4. 解译结果的导出请参考[文档](./export_results.md)。

### 高级功能

+ 为提升算法效果，支持对输入影像对进行滑窗推理。在开始处理前，通过滑动“自定义窗口”和“自定义步长”滑块可以选择滑窗尺寸与移动步长。

+ 在进行变化检测前，可对输入图像进行增强。点击选项框添加需要进行的图像增强操作。启用图像增强功能后，可在界面预览处理结果。备选项如下：
    - **直方图匹配**：适用于两幅图像风格差异比较大的情况，效果为使两幅图像的灰度值分布尽可能保持一致。
    - **锐化**：适用于图像分辨率较低或建筑物边缘模糊的情况，效果为增强建筑物的边缘、轮廓。

+ 在进行变化检测前，可对输入图像进行降噪。点击选项框添加需要进行的图像降噪操作。备选项如下：
    - **平滑**：对影像进行中值滤波，适合用于去除类椒盐噪声。
    - **滤波**：对影像进行高斯滤波，适合用于去除类高斯噪声。

+ 对变化检测结果提供2种可选的预览模式，通过点击“切换预览模式”可以在两种模式之间切换：
    - 滑窗预览模式。这是默认的预览模式。可通过拖动滑块对比两个时相影像间的差异，变化检测结果以轮廓图的形式呈现。
    - 普通预览模式。将两个时相的影像以及变化检测结果并列呈现。在这种模式下，可在右侧的“结果图渲染”框中修改结果图像的配色方案。备选方案有：
        * 原图
        * 森林
        * 霓虹
        * 闪电
        * 极光

        修改配色方案效果如下图所示：

        <p align="center">
            <img src="https://user-images.githubusercontent.com/21275753/199180315-784e57a7-2f9f-4552-8983-46bb7611eabd.gif" alt = "color" width = "600" />
        </p>

+ 在进行变化检测后，可对结果图像进行后处理。勾选“开启连通域滤波并填充孔洞处理”以启用此功能。备选项如下：
    - **连通域滤波+孔洞填充**：去除伪变化噪声点以及填充变化区域内的孔洞，使结果更加接近真实情况。效果如下图所示：

    <p align="center">
        <img src="https://user-images.githubusercontent.com/21275753/199180339-dccdb321-439a-4a5b-b972-dd66162305d3.gif" alt = "filter" width = "600" />
    </p>

关于图像增强、图像降噪以及变化检测结果后处理功能的更多细节，请参考[文档](./functions.md)。
